[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=d333f8ec-12cc-4719-97b0-6423cab4656f
Description=脚本
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Sub test()
	Call openExcel()
	Call TestMain()
End Sub

'''''''''''''''''''''''''''''''''''''''''''''''''''
'点击开始按钮执行操作
'''''''''''''''''''''''''''''''''''''''''''''''''''
Event Form1.Button1.Click
	Call InitPage()
	
	MsgBox "完成"
End Event

'''''''''''''''''''''''''''''''''''''
'点击开始按钮后的主入口
'''''''''''''''''''''''''''''''''''''
Sub Start()
Dim arr
arr = Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
Call InitPage()
MsgBox arr(27)
End Sub

''''''''''''''''''''''''''''''''''''''
'等待Tag存在
''''''''''''''''''''''''''''''''''''''
Function waitTagExists(Tag)
	linkTag = 0
	tick = 0
	While (linkTag = 0 And tick < 50)
		Delay 100
		linkTag = Plugin.Web.HtmlExists(Tag)
		tick = tick + 1
	Wend
	If (tick >= 50) Then 
		MsgBox Tag + "超时"
	End If
End Function

''''''''''''''''''''''''''''''''''''''
'点击Tag
''''''''''''''''''''''''''''''''''''''
Function clickTag(tag)
	Call Plugin.Web.HtmlClick(tag)
End Function

''''''''''''''''''''''''''''''''''''''
'到第i页面
''''''''''''''''''''''''''''''''''''''
Function moveToPage(i)
	
	pageRange = pageAtWhichRange()
	
	If pageRange = 0 Then 
		If i > 0 And i < 11 Then
			pageTag = pageTagStr(i)
			waitTagExists (pageTag)
			clickTag (pageTag)
			nowPageTag = nowPageTagStr(i)
			waitTagExists(nowPageTag)
		Else 
			If i > 10 And i < 21 Then 
				pageTag = pageTagStr(i) 
				Call moveFrom0To1() ''此时起点为页面11
				If i = 11 Then 
					nowPageTag = nowPageTagStr(11)
					waitTagExists(nowPageTag)
				Else 
					waitTagExists (pageTag)
					clickTag (pageTag)
					nowPageTag = nowPageTagStr(i)
					waitTagExists(nowPageTag)
				End If
			Else 
				If i > 20 And i < 26 Then 
					pageTag = pageTagStr(i)
					Call moveFrom0To2() ''此时起点为页面21
					If i = 21 Then 
						nowPageTag = nowPageTagStr(21)
						waitTagExists(nowPageTag)
					Else 
						waitTagExists (pageTag)
						clickTag (pageTag)
						nowPageTag = nowPageTagStr(i)
						waitTagExists(nowPageTag)
					End If
				End If
			End If
		End If
	End If
	If pageRange = 1 Then 
		If i > 0 And i < 11 Then 
			pageTag = pageTagStr(i)
			Call moveFrom1To0() ''此时起点为页面1
			If i = 1 Then 
				nowPageTag = nowPageTagStr(1)
				waitTagExists (nowPageTag)
			Else 
				waitTagExists (pageTag)
				clickTag(pageTag)
				nowPageTag = nowPageTagStr(i)
				waitTagExists(nowPageTag)
			End If
		Else 
			If i > 10 And i < 21 Then 
				pageTag = pageTagStr(i)
				waitTagExists (pageTag)
				clickTag (pageTag)
				nowPageTag = nowPageTagStr(i)
				waitTagExists (nowPageTag)
			Else 
				If i > 20 And i < 26 Then 
					pageTag = pageTagStr(i)
					Call moveFrom1To2()''此时起点为页面21
					If i = 21 Then 
						nowPageTag = nowPageTagStr(21)
						waitTagExists (nowPageTag)
					Else 
						waitTagExists (pageTag)
						clickTag (pageTag)
						nowPageTag = nowPageTagStr(i)
						waitTagExists(nowPageTag)
					End If
				End If
			End If
		End If
	End If
	If pageRange = 2 Then 
		If i > 0 And i < 11 Then 
			pageTag = pageTagStr(i)
			Call moveFrom2To0()
			If i = 1 Then 
				nowPageTag = nowPageTagStr(1)
				waitTagExists(nowPageTag)
			Else 
				waitTagExists (pageTag)
				clickTag (pageTag)
				nowPageTag = nowPageTagStr(i)
				waitTagExists(nowPageTag)
			End If
		Else 
			If i > 10 And i < 21 Then 
				pageTag = pageTagStr(i)
				Call moveFrom2To1()
				If i = 11 Then 
					nowPageTag = nowPageTagStr(11)
					waitTagExists (nowPageTag)
				Else 
					waitTagExists (pageTag)
					clickTag (pageTag)
					nowPageTag = nowPageTagStr(i)
					waitTagExists(nowPageTag)
				End If
			Else 
				If i > 20 And i < 26 Then 
					pageTag = pageTagStr(i)
					waitTagExists (pageTag)
					clickTag (pageTag)
					nowPageTag = nowPageTagStr(i)
					waitTagExists (nowPageTag)
				End If
			End If
		End If
	End If
	
	nowPageTag = nowPageTagStr(i)
	waitTagExists(nowPageTag)
End Function

''''''''''''''''''''''''''''''''''''''
'判断在1-10 or 11-20 or 21-25页
''''''''''''''''''''''''''''''''''''''
Function pageAtWhichRange()
	onePageTag =  "tag:A&txt:1"
	twoPageTag =  "tag:A&txt:2"
	elevenPageTag = "tag:A&txt:11"
	twelvePageTag = "tag:A&txt:12"
	twentyonePageTag = "tag:A&txt:21"
	twentytwoPageTag = "tag:A&txt:22"
	cnt = 0
	flag = 0
	While flag = 0 and cnt < 51
		If Plugin.Web.HtmlExists(onePageTag) > 0 or Plugin.Web.HtmlExists(twoPageTag) > 0 Then 
			flag = 1
			pageAtWhichRange = 0
		Else 
			If Plugin.Web.HtmlExists(elevenPageTag) > 0 or Plugin.Web.HtmlExists(twelvePageTag) > 0 Then 
				flag = 1
				pageAtWhichRange = 1
			Else 
				If Plugin.Web.HtmlExists(twentyonePageTag) > 0 or Plugin.Web.HtmlExists(twentytwoPageTag) > 0 Then 
					flag = 1
					pageAtWhichRange = 2
				Else 
					Delay 100
					If cnt = 50 Then 
						MsgBox "判断页面范围错误"
						Delay 5000
					End If
				End If
			End If
		End If
		cnt = cnt + 1
		
	Wend
	
End Function

Function pageTagStr(i)
	pageTagStr = "tag:A&txt:" + CStr(i)
End Function

Function nowPageTagStr(i)
	nowPageTagStr = "tag:SPAN&txt:" + CStr(i) + "&index:1"
End Function

''''''''''''''''''''''''''''''''''''''
'从1-10 至 11
''''''''''''''''''''''''''''''''''''''
Function moveFrom0To1()
	cnt = 1
	flag = 0
	linkNum = 0
	While (cnt < 11 and flag = 0)
		nowPageTag = nowPageTagStr(cnt)
		linkNum = Plugin.Web.HtmlExists(nowPageTag)
		If linkNum <> 0 Then 
			If cnt = 1 Then 
				nowPageTag = nowPageTagStr(1)
				waitTagExists(nowPageTag)
			Else 
				homePageTag = "tag:IMG&index:68"
				waitTagExists (homePageTag)
				clickTag (homePageTag)
				nowPageTag = nowPageTagStr(1)
				waitTagExists(nowPageTag)
			End If
			flag = 1
		End If
		cnt = cnt + 1
	Wend
	If flag <> 1 Then 
		MsgBox "进入首页错误"
	End If
	nextTenPageTag = "tag:IMG&index:66"
	waitTagExists(nextTenPageTag)
	clickTag (nextTenPageTag)
	nowPageTag = nowPageTagStr(11)
	waitTagExists (nowPageTag)
End Function

''''''''''''''''''''''''''''''''''''''
'从1-10 至 21
''''''''''''''''''''''''''''''''''''''
Function moveFrom0To2()
	Call moveFrom0To1()
	nowPageTag = nowPageTagStr(11)
	waitTagExists (nowPageTag)
	nextTenPageTag = "tag:IMG&index:72"
	Call Plugin.Web.HtmlClick(nextTenPageTag)
	nowPageTag = nowPageTagStr(21)
	waitTagExists (nowPageTag)
End Function
''''''''''''''''''''''''''''''''''''''
'从11-20 至 1
''''''''''''''''''''''''''''''''''''''
Function moveFrom1To0()
	homePageTag = "tag:IMG&index:68"
	waitTagExists (homePageTag)
	Call Plugin.Web.HtmlClick(homePageTag)
	nowPageTag = nowPageTagStr(1)
	waitTagExists(1)
End Function
''''''''''''''''''''''''''''''''''''''
'从11-20 至 21
''''''''''''''''''''''''''''''''''''''
Function moveFrom1To2()
	Call moveFrom1To0()
	Call moveFrom0To1()
	nextTenPageTag = "tag:IMG&index:72"
	waitTagExists(nextTenPageTag)
	Call Plugin.Web.HtmlClick(nextTenPageTag)
	nowPageTag = nowPageTagStr(21)
	waitTagExists (nowPageTag)
End Function
''''''''''''''''''''''''''''''''''''''
'从21-25 至 1
''''''''''''''''''''''''''''''''''''''
Function moveFrom2To0()
	homePageTag = "tag:IMG&index:68"
	waitTagExists (homePageTag)
	Call Plugin.Web.HtmlClick(homePageTag)
	nowPageTag = nowPageTagStr(1)
	waitTagExists(nowPageTag)
End Function
''''''''''''''''''''''''''''''''''''''
'从21-25 至 11
''''''''''''''''''''''''''''''''''''''
Function moveFrom2To1()
	Call moveFrom2To0()
	Call moveFrom0To1()
End Function

''''''''''''''''''''''''''''''''''''''
'移动滚动条至指定位置，方便进行换页或数据处理
'需先将滚动条移至顶部
''''''''''''''''''''''''''''''''''''''
Sub moveTheScrollbar()
	MoveTo 1912, 261
	Delay 50
	LeftDown 1
	MoveTo 1919, 547
	Delay 50
	LeftUp 1
	Delay 1
	LeftUp 1
End Sub

'''''''''''''''''''''''''''''''''''''
'将滚动条移动至页面顶端
'''''''''''''''''''''''''''''''''''''
Sub moveScrollbarToTop()
MoveTo 1913, 99
Delay 72
KeyUp "F1", 1
Delay 3
Delay 290
LeftDown 1
LeftDown 1
Delay 1128
LeftUp 1
Delay 2
LeftUp 1
Delay 266
KeyDown "F2", 1
End Sub

Sub quickMoveToTop()
MoveTo 1908, 632
Delay 103
LeftDown 1
Delay 4
LeftDown 1
MoveTo 1908, 74
LeftUp 1
Delay 1
LeftUp 1
End Sub

''''''''''''''''''''''''''''''''''''''
'页面初始化，使得屏幕显示页面为指定页面
''''''''''''''''''''''''''''''''''''''
Sub InitPage()
	Call Plugin.Web.Bind("WQM.exe")   
	Call Plugin.Web.Go("www.pceggs.com")
	Hwnd = Plugin.Window.Find(0, "WQM 1.20 - [游戏试玩平台_玩游戏赚钱_PC蛋蛋官网]")
	Call Plugin.Window.Max(Hwnd)
	Delay 100
	Call Plugin.Web.LeftClick(1160, 80)
	enterTag = "tag:A&txt:马上去猜"
	waitTagExists (enterTag)
	Call Plugin.Web.HtmlClick(enterTag)
End Sub




''''''''''''''''''''''''''''''''''''''''''''''''''
'获取开始期号，返回字符串
''''''''''''''''''''''''''''''''''''''''''''''''''
Function getStartNum()
	getStartNum = Form1.InputBox1.Text
End Function

''''''''''''''''''''''''''''''''''''''''''''''''''
'获取结束期号，返回字符串
''''''''''''''''''''''''''''''''''''''''''''''''''
Function getEndNum()
	getEndNum = Form1.InputBox2.Text
End Function

'''''''''''''''''''''''''''''''''''''''''''''''''
'移动至第i行期号
'''''''''''''''''''''''''''''''''''''''''''''''''
Function moveToRow(i)
	Y = 184 + 41*(i-1)
	MoveTo 390 , Y
End Function

'''''''''''''''''''''''''''''''''''''''''''''''''
'移动至第i行结果
'''''''''''''''''''''''''''''''''''''''''''''''''
Function moveToResult(i)
	Y = 184 + 41 * (i - 1)
	MoveTo 1475, Y
End Function

'''''''''''''''''''''''''''''''''''''''''''''''''
'进入第i行结果
'''''''''''''''''''''''''''''''''''''''''''''''''
Function enterResult(i)
	resultTag = "tag:A&txt:已揭晓&index:" + CStr(i - 1)
	waitTagExists(resultTag)
	Call Plugin.Web.HtmlClick(resultTag)
End Function

'''''''''''''''''''''''''''''''''''''''''''''''''
'获取第i行期号
'''''''''''''''''''''''''''''''''''''''''''''''''
Function getRowNum(i)
	Delay 500
	rowNumTag = "tag:TD&index:" + CStr(11 + (i - 1) * 8)
	waitTagExists(rowNumTag)
	getRowNum = Plugin.Web.HtmlGet("text", rowNumTag)
End Function

'''''''''''''''''''''''''''''''''''''''''''''''''
'获取第i行第1个数字
'''''''''''''''''''''''''''''''''''''''''''''''''
Function getNumOneOfRow(i)
	Y = 190 + 41*(i-1)
	MoveTo 673, Y
	LeftDoubleClick 1
	Call Copy()
	getNumOneOfRow = Plugin.Sys.GetCLB()
End Function

'''''''''''''''''''''''''''''''''''''''''''''''''
'获取第i行第2个数字
'''''''''''''''''''''''''''''''''''''''''''''''''
Function getNumTwoOfRow(i)
	Y = 190 + 41 * (i - 1)
	MoveTo 702, Y
	LeftDoubleClick 1
	Call Copy()
	getNumTwoOfRow = Plugin.Sys.GetCLB()
End Function

'''''''''''''''''''''''''''''''''''''''''''''''''
'获取第i行第3个数字
'''''''''''''''''''''''''''''''''''''''''''''''''
Function getNumThreeOfRow(i)
	Y = 190 + 41 * (i - 1)
	MoveTo 731, Y
	LeftDoubleClick 1
	Call Copy()
	getNumThreeOfRow = Plugin.Sys.GetCLB()
End Function

'''''''''''''''''''''''''''''''''''''''''''''''''
'获取第i行全部三个数字
'''''''''''''''''''''''''''''''''''''''''''''''''
Function getAllThreeNumOfRow(i)
	Delay 100
	arrNum = Array("","","")
	rowTag = "tag:TD&index:" + CStr(13 + (i - 1) * 8)
	waitTagExists(rowTag)
	wholeString = Plugin.Web.HtmlGet("text", rowTag)
	firstSplitString = Split(wholeString,"+",-1,1)
	arrNum(0) = firstSplitString(0)
	arrNum(1) = firstSplitString(1)
	secondSplitString = Split(firstSplitString(2), "=", -1,1)
	arrNum(2) = secondSplitString(0)
	getAllThreeNumOfRow = arrNum
End Function


'''''''''''''''''''''''''''''''''''''''''''''''''
'获取28个赔率
'''''''''''''''''''''''''''''''''''''''''''''''''
Function getAllOdds(arr)
	Delay 200
	For i = 0 To 27
		oddsTag = "tag:TD&index:" + CStr(18 + 4 * i)
		waitTagExists(oddsTag)
		arr(i) = Plugin.Web.HtmlGet("text", oddsTag)
	Next
	getAllOdds = arr
End Function

''''''''''''''''''''''''''''''''''''''''''''''''''
'执行copy操作
''''''''''''''''''''''''''''''''''''''''''''''''''
Sub Copy()
	KeyDown "Ctrl", 1
	Delay 5
	Delay 50
	KeyDown "C", 1
	Delay 1
	Delay 50
	KeyUp "C", 1
	Delay 1
	Delay 35
	KeyUp "Ctrl", 1
	Delay 2
End Sub

''''''''''''''''''''''''''''''''''''''''''''''''''
'获取复制的内容
''''''''''''''''''''''''''''''''''''''''''''''''''
Function getCopy()
	getCopy = Plugin.Sys.GetCLB()
End Function

''''''''''''''''''''''''''''''''''''''''''''''''''
'打开Excel文档，并返回index
''''''''''''''''''''''''''''''''''''''''''''''''''
Function openExcel()
	openExcel = Plugin.LazyOffice.ExcelOpen("D:\Test\anjian.xlsx",1)
End Function

''''''''''''''''''''''''''''''''''''''''''''''''''
'返回上一页
''''''''''''''''''''''''''''''''''''''''''''''''''
Sub goBack()
	Call Plugin.Web.Back()
End Sub

''''''''''''''''''''''''''''''''''''''''''''''''''
'滚动条移动至底部
''''''''''''''''''''''''''''''''''''''''''''''''''
Sub moveScrollbarToBottom()
	MoveTo 1909, 236
	Delay 50
	LeftDown 1
	Delay 6
	LeftDown 1
	MoveTo 1919, 868
	Delay 1
	LeftUp 1
	Delay 1
	LeftUp 1
End Sub

''''''''''''''''''''''''''''''''''''''''''''''''''
'ExcelWrite写入数据
''''''''''''''''''''''''''''''''''''''''''''''''''
Function writeToExcel(page, row, col, data)
	Call Plugin.LazyOffice.ExcelWrite(page,row,col,data)
	writeToExcel = 1
End Function

Function excelInsertRow(page, row)
	Call Plugin.LazyOffice.ExcelRows(page, row, "插入", 1)
	excelInsertRow = 1
End Function
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'测试分割线
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''


Event Form1.Button2.Click
	Call test()
End Event


''''''''''''''''''''''''''''''''''''''''''''''''''
'测试移动
''''''''''''''''''''''''''''''''''''''''''''''''''
Sub TestMain()
	STAGE_COLUMN = 1
	FIRST_NUM_COLUMN = STAGE_COLUMN + 1
	FIRST_ODD_COLUMN = FIRST_NUM_COLUMN + 5
	END_NUM = getEndNum()
	Call InitPage()
	For page = 16 To 25
		arr = Array(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
		Delay 2000
		moveToPage (page)
		Delay 500
		For pageRow = 1 To 20
			stageNum = getRowNum(pageRow)
			If (CStr(stageNum) = CStr(END_NUM) Or stageNum = ""Or stageNum = " ") Then 
			 	Goto 结束
			End If
			Delay 200
			allThreeNum = getAllThreeNumOfRow(pageRow)
			garbage = writeToExcel(1, 2, STAGE_COLUMN, stageNum)
			firstNum = allThreeNum(0)
			garbage = writeToExcel(1,2,FIRST_NUM_COLUMN,firstNum)
			secondNum = allThreeNum(1)
			garbage = writeToExcel(1, 2, FIRST_NUM_COLUMN + 1, secondNum)
			thridNum = allThreeNum(2)
			garbage = writeToExcel(1, 2, FIRST_NUM_COLUMN + 2, thridNum)
			''sumNum = CInt(Left(firstNum,1)) + CInt(Left(secondNum,1)) + CInt(Left(thridNum,1))
			''garbage = writeToExcel(1, 2, FIRST_NUM_COLUMN + 3, sumNum)
			enterResult (pageRow)
			Delay 200
			arr = getAllOdds(arr)
			For i = 0 To 27
				garbage = writeToExcel(1,2,FIRST_ODD_COLUMN + i,arr(i))
			Next
			Call goBack()
			garbage = excelInsertRow(1, 2)
			Delay 500
		Next
	Next
	Rem 结束
End Sub

Function getTheWhoolRowInf(pageRow)
	STAGE_COLUMN = 1
	FIRST_NUM_COLUMN = STAGE_COLUMN + 1
	FIRST_ODD_COLUMN = FIRST_NUM_COLUMN + 5
	END_NUM = getEndNum()
	arr = Array(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
	stageNum = getRowNum(pageRow)
		If (CStr(stageNum) = CStr(END_NUM) Or stageNum = ""Or stageNum = " ") Then 
		 	Goto 结束
		End If
	Delay 200
	allThreeNum = getAllThreeNumOfRow(pageRow)
	garbage = writeToExcel(1, 2, STAGE_COLUMN, stageNum)
	firstNum = allThreeNum(0)
	garbage = writeToExcel(1,2,FIRST_NUM_COLUMN,firstNum)
	secondNum = allThreeNum(1)
	garbage = writeToExcel(1, 2, FIRST_NUM_COLUMN + 1, secondNum)
	thridNum = allThreeNum(2)
	garbage = writeToExcel(1, 2, FIRST_NUM_COLUMN + 2, thridNum)
	''sumNum = CInt(Left(firstNum,1)) + CInt(Left(secondNum,1)) + CInt(Left(thridNum,1))
	''garbage = writeToExcel(1, 2, FIRST_NUM_COLUMN + 3, sumNum)
	enterResult (pageRow)
	Delay 200
	arr = getAllOdds(arr)
	For i = 0 To 27
		garbage = writeToExcel(1,2,FIRST_ODD_COLUMN + i,arr(i))
	Next
	Call goBack()
	garbage = excelInsertRow(1, 2)
	Delay 500
	Rem 结束
End Function

Sub AddLostData()
	Call openExcel()
	STAGE_COLUMN = 1
	FIRST_NUM_COLUMN = STAGE_COLUMN + 1
	FIRST_ODD_COLUMN = FIRST_NUM_COLUMN + 5
	If Form1.InputBox3.Text = "" Then
		MsgBox "填入信息为空"
		Goto 结束
	End If
	lostDataNum = CInt(Right(Form1.InputBox3.Text, 4))
	Call InitPage()
	moveToPage (2)
	stageNum = getRowNum(1)
	secondPageFirstRowNum = CInt(Right(stageNum, 4))
	internal = secondPageFirstRowNum - lostDataNum
	addRow = internal Mod 20
	If addRow > 20 Then 
		MsgBox "填补信息行数错误"
		Goto 结束
	End If
	addPage = (internal - addRow) / 20
	If addPage > 25 Then 
		MsgBox "填补信息页数错误"
		Goto 结束
	End If
	moveToPage (2 + addPage)
	getTheWhoolRowInf (1 + addRow)
	Rem 结束
End Sub

Event Form1.Button3.Click
	Call AddLostData()
End Event
Event Form1.Label3.Click

End Event
Event Form1.InputBox3.Change

End Event
Event Form1.InputBox1.Change

End Event
